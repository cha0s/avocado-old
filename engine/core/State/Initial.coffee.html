<!DOCTYPE html><html><head><title>Initial.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../engine/core/CoreService.coffee.html" class="source "><span class="base_path">engine / core / </span><span class="file_name">CoreService.coffee</span></a><a href="../../../engine/core/Debug/Execution.coffee.html" class="source "><span class="base_path">engine / core / Debug / </span><span class="file_name">Execution.coffee</span></a><a href="../../../engine/core/Entity/Entity.coffee.html" class="source "><span class="base_path">engine / core / Entity / </span><span class="file_name">Entity.coffee</span></a><a href="../../../engine/core/Entity/Traits/Existence.coffee.html" class="source "><span class="base_path">engine / core / Entity / Traits / </span><span class="file_name">Existence.coffee</span></a><a href="../../../engine/core/Entity/Traits/Mobility.coffee.html" class="source "><span class="base_path">engine / core / Entity / Traits / </span><span class="file_name">Mobility.coffee</span></a><a href="../../../engine/core/Entity/Traits/Trait.coffee.html" class="source "><span class="base_path">engine / core / Entity / Traits / </span><span class="file_name">Trait.coffee</span></a><a href="../../../engine/core/Entity/Traits/Visibility.coffee.html" class="source "><span class="base_path">engine / core / Entity / Traits / </span><span class="file_name">Visibility.coffee</span></a><a href="../../../engine/core/Environment/2D/Environment.coffee.html" class="source "><span class="base_path">engine / core / Environment / 2D / </span><span class="file_name">Environment.coffee</span></a><a href="../../../engine/core/Environment/2D/Room.coffee.html" class="source "><span class="base_path">engine / core / Environment / 2D / </span><span class="file_name">Room.coffee</span></a><a href="../../../engine/core/Environment/2D/TileLayer.coffee.html" class="source "><span class="base_path">engine / core / Environment / 2D / </span><span class="file_name">TileLayer.coffee</span></a><a href="../../../engine/core/Environment/2D/Tileset.coffee.html" class="source "><span class="base_path">engine / core / Environment / 2D / </span><span class="file_name">Tileset.coffee</span></a><a href="../../../engine/core/Extension/Rectangle.coffee.html" class="source "><span class="base_path">engine / core / Extension / </span><span class="file_name">Rectangle.coffee</span></a><a href="../../../engine/core/Extension/String.coffee.html" class="source "><span class="base_path">engine / core / Extension / </span><span class="file_name">String.coffee</span></a><a href="../../../engine/core/Extension/Vector.coffee.html" class="source "><span class="base_path">engine / core / Extension / </span><span class="file_name">Vector.coffee</span></a><a href="../../../engine/core/Graphics/Animation.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">Animation.coffee</span></a><a href="../../../engine/core/Graphics/DisplayList.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">DisplayList.coffee</span></a><a href="../../../engine/core/Graphics/GraphicsService.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">GraphicsService.coffee</span></a><a href="../../../engine/core/Graphics/Image.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">Image.coffee</span></a><a href="../../../engine/core/Graphics/RasterFont.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">RasterFont.coffee</span></a><a href="../../../engine/core/Graphics/Window.coffee.html" class="source "><span class="base_path">engine / core / Graphics / </span><span class="file_name">Window.coffee</span></a><a href="../../../engine/core/Main.coffee.html" class="source "><span class="base_path">engine / core / </span><span class="file_name">Main.coffee</span></a><a href="../../../engine/core/Sound/Music.coffee.html" class="source "><span class="base_path">engine / core / Sound / </span><span class="file_name">Music.coffee</span></a><a href="../../../engine/core/Sound/Sample.coffee.html" class="source "><span class="base_path">engine / core / Sound / </span><span class="file_name">Sample.coffee</span></a><a href="../../../engine/core/State/AbstractState.coffee.html" class="source "><span class="base_path">engine / core / State / </span><span class="file_name">AbstractState.coffee</span></a><a href="../../../engine/core/State/Environment.coffee.html" class="source "><span class="base_path">engine / core / State / </span><span class="file_name">Environment.coffee</span></a><a href="../../../engine/core/State/Initial.coffee.html" class="source selected"><span class="base_path">engine / core / State / </span><span class="file_name">Initial.coffee</span></a><a href="../../../engine/core/Timing/Counter.coffee.html" class="source "><span class="base_path">engine / core / Timing / </span><span class="file_name">Counter.coffee</span></a><a href="../../../engine/core/Timing/Cps.coffee.html" class="source "><span class="base_path">engine / core / Timing / </span><span class="file_name">Cps.coffee</span></a><a href="../../../engine/core/Timing/Ticker.coffee.html" class="source "><span class="base_path">engine / core / Timing / </span><span class="file_name">Ticker.coffee</span></a><a href="../../../engine/core/Timing/TimingService.coffee.html" class="source "><span class="base_path">engine / core / Timing / </span><span class="file_name">TimingService.coffee</span></a><a href="../../../engine/core/Utility/EventEmitter.coffee.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">EventEmitter.coffee</span></a><a href="../../../engine/core/Utility/Logger.coffee.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">Logger.coffee</span></a><a href="../../../engine/core/Utility/Mixin.coffee.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">Mixin.coffee</span></a><a href="../../../engine/core/Utility/Transition.coffee.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">Transition.coffee</span></a><a href="../../../engine/core/Utility/quadtree.js.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">quadtree.js</span></a><a href="../../../engine/core/Utility/underscore-min.js.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">underscore-min.js</span></a><a href="../../../engine/core/Utility/upon.js.html" class="source "><span class="base_path">engine / core / Utility / </span><span class="file_name">upon.js</span></a><a href="../../../engine/main/native/Finish.coffee.html" class="source "><span class="base_path">engine / main / native / </span><span class="file_name">Finish.coffee</span></a><a href="../../../engine/main/native/Initialize.coffee.html" class="source "><span class="base_path">engine / main / native / </span><span class="file_name">Initialize.coffee</span></a><a href="../../../engine/main/native/Main.coffee.html" class="source "><span class="base_path">engine / main / native / </span><span class="file_name">Main.coffee</span></a><a href="../../../engine/scratch.coffee.html" class="source "><span class="base_path">engine / </span><span class="file_name">scratch.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>Initial.coffee</h1><div class="filepath">engine/core/State/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><p>Avocado loads the 'Initial' state, and from there it's all up to you!</p>
</td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nx">avo</span><span class="p">.</span><span class="nx">Main</span><span class="p">.</span><span class="nx">States</span><span class="p">[</span><span class="s1">&#39;Initial&#39;</span><span class="p">]</span> <span class="k">extends</span> <span class="nx">avo</span><span class="p">.</span><span class="nx">AbstractState</span>
  </pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>Called the first time this state is loaded. You can set up any stuff your
state needs here. This is the Initial state, so we can also set up
things specific to our game.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">initialize: </span><span class="o">-&gt;</span>
    </pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>Register a player 'Awesome player' to receive input using the
keyboard arrow keys and joystick index 0.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">registerPlayerMovement</span> <span class="s1">&#39;Awesome player&#39;</span><span class="p">,</span> <span class="p">[</span>
      <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">SpecialKeyCodes</span><span class="p">.</span><span class="nx">UpArrow</span>
      <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">SpecialKeyCodes</span><span class="p">.</span><span class="nx">RightArrow</span>
      <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">SpecialKeyCodes</span><span class="p">.</span><span class="nx">DownArrow</span>
      <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">SpecialKeyCodes</span><span class="p">.</span><span class="nx">LeftArrow</span>
    <span class="p">],</span> <span class="mi">0</span>
    </pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>Last, we'll open the window where we show all of the graphics
stuff. We'll wait so that there isn't a black screen sitting
there while everything loads.
Instantiate a Window to receive render events.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">avo.window = </span><span class="k">new</span> <span class="nx">avo</span><span class="p">.</span><span class="nx">graphicsService</span><span class="p">.</span><span class="nx">newWindow</span> <span class="p">[</span><span class="mi">720</span><span class="p">,</span> <span class="mi">450</span><span class="p">]</span>
    <span class="nx">avo</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">setWindowTitle</span> <span class="s1">&#39;Avocado - Fun Should Be Free&#39;</span>
    <span class="nv">avo.window.originalSize = </span><span class="p">[</span><span class="mi">720</span><span class="p">,</span> <span class="mi">450</span><span class="p">]</span>
    </pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>@main lets us know when it has something to render, so we'll
put it on our window.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">@main</span><span class="p">.</span><span class="kc">on</span> <span class="s1">&#39;render&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">rectangle</span><span class="p">)</span> <span class="o">=&gt;</span>
      </pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>Render and display the changes to the window.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">avo</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">render</span> <span class="nx">buffer</span><span class="p">,</span> <span class="nx">rectangle</span>
      <span class="nx">avo</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">display</span><span class="p">()</span>
      </pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Catch the quit event (window close event).</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">avo</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="kc">on</span> <span class="s1">&#39;quit.InitialState&#39;</span><span class="p">,</span> <span class="o">=&gt;</span> <span class="nx">@main</span><span class="p">.</span><span class="nx">quit</span><span class="p">()</span>
    
    <span class="nv">defer = </span><span class="nx">upon</span><span class="p">.</span><span class="nx">defer</span><span class="p">()</span>
    <span class="nx">defer</span><span class="p">.</span><span class="nx">resolve</span><span class="p">()</span>
    <span class="nx">defer</span><span class="p">.</span><span class="nx">promise</span>
        </pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Called repeatedly while this state is loaded. You can do things like
update your world here. We'll move the avocado based on movement input.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">tick: </span><span class="o">-&gt;</span>
    
    <span class="nx">@main</span><span class="p">.</span><span class="nx">changeState</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="nv">environmentUri: </span><span class="s1">&#39;/environment/wb-forest.environment.json&#39;</span>
    </pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>Called repeatedly to allow the state to render graphics.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">render: </span><span class="nf">(buffer) -&gt;</span>
    </pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>Called when another state is loaded. This gives you a chance to clean
up resources and event handlers.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">leave: </span><span class="nf">(nextStateName) -&gt;</span>

</pre></div></td></tr></tbody></table><div id="projectname"><a href="../../../index.html">Avocado</a></div></div></body></html>